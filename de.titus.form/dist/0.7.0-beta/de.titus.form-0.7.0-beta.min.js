(function(){de.titus.core.Namespace.create("de.titus.form.Setup",function(){de.titus.form.Setup={fieldtypes:{}};});})();(function(){de.titus.core.Namespace.create("de.titus.form.Constants",function(){de.titus.form.Constants.TYPES={PAGE:"page",SUMMARY_PAGE:"summary-page",SUBMITTED_PAGE:"submitted-page"};de.titus.form.Constants.EVENTS={INITIALIZED:"form-initialized",SUCCESSED:"form-successed",FAILED:"form-failed",STATE_CHANGED:"form-state-changed",ACTION_RESET:"form-action-reset",ACTION_SUBMIT:"form-action-submit",ACTION_PAGE_BACK:"form-action-page-back",ACTION_PAGE_NEXT:"form-action-page-next",ACTION_SUMMARY:"form-action-page-summary",ACTION_LIST_FIELD_ADD:"form-action-list-field-add",ACTION_LIST_FIELD_REMOVE:"form-action-list-field-remove",PAGE_INITIALIZED:"form-page-initialized",PAGE_CHANGED:"form-page-changed",PAGE_SHOW:"form-page-show",PAGE_HIDE:"form-page-hide",PAGE_SUMMARY:"form-page-summary",PAGE_SUBMITTED:"form-page-submitted",FIELD_VALIDATED:"form-field-validated",FIELD_SHOW:"form-field-show",FIELD_HIDE:"form-field-hide",FIELD_SUMMARY:"form-field-SUMMARY",FIELD_VALUE_CHANGED:"form-field-value-changed",VALIDATION_STATE_CHANGED:"form-validation-state-changed",VALIDATION_VALID:"form-validation-valid",VALIDATION_INVALID:"form-validation-invalid",CONDITION_STATE_CHANGED:"form-condition-state-changed",CONDITION_MET:"form-condition-met",CONDITION_NOT_MET:"form-condition-not-met"};
de.titus.form.Constants.STATE={INPUT:"form-state-input",SUBMITTED:"form-state-submitted"};de.titus.form.Constants.ATTRIBUTE={VALIDATION:"-validation",VALIDATION_FAIL_ACTION:"-validation-fail-action",CONDITION:"-condition",MESSAGE:"-message"};de.titus.form.Constants.SPECIALSTEPS={START:"form-step-start",SUMMARY:"form-step-summary",SUBMITTED:"form-step-submitted"};de.titus.form.Constants.STRUCTURELEMENTS={FORM:{selector:"[data-form]"},PAGE:{selector:"[data-form-page]"},SINGLEFIELD:{selector:"[data-form-field]"},CONTAINERFIELD:{selector:"[data-form-container-field]"},LISTFIELD:{selector:"[data-form-list-field]"}};});})();(function(){de.titus.core.Namespace.create("de.titus.form.Registry",function(){var a=de.titus.form.Registry={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.Registry"),FIELDCONTROLLER:{},registFieldController:function(c,b){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug('registFieldController ("'+c+'")');}a.FIELDCONTROLLER[c]=b;},getFieldController:function(c,d){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug('getFieldController ("'+c+'")');
}var b=a.FIELDCONTROLLER[c];if(b){return b(d);}else{return a.FIELDCONTROLLER["default"](d);}}};});})();(function(a){de.titus.core.Namespace.create("de.titus.form.utils.EventUtils",function(){var b=de.titus.form.utils.EventUtils={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.utils.EventUtils"),triggerEvent:function(e,d,c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug('triggerEvent("'+d+'")');}b.__checkOfUndefined(d);setTimeout((function(g,f){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug(['fire event event "',g,'"\non ',this,'\nwith data "'+f+'"!']);}this.trigger(g,f);}).bind(e,d,c),1);},handleEvent:function(f,e,d,c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug(['handleEvent "',e,'"\nat ',f,"\nwith selector ",c]);}b.__checkOfUndefined(e);if(Array.isArray(e)){f.on(e.join(" "),c,d);}else{f.on(e,c,d);}},__checkOfUndefined:function(d){if(Array.isArray(d)){for(var c=0;c<d.length;c++){if(d[c]===undefined){throw new Error('Error: undefined value at array index "'+c+'"');
}else{if(d===undefined){throw new Error("Error: undefined value");}}}}}};});})($);(function(a){de.titus.core.Namespace.create("de.titus.form.utils.FormularUtils",function(){var b=de.titus.form.utils.FormularUtils={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.utils.FormularUtils"),getFormularElement:function(c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("getFormularElement()");}if(c.is("[data-form]")){return c;}else{return c.parents("[data-form]").first();}},getFormular:function(d){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("getFormular()");}var c=b.getFormularElement(d);if(c){return c.Formular();}},getPage:function(d){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("getPage()");}if(d.is("[data-form]")){return undefined;}else{if(d.is("[data-form-page]")){return d.formular_Page();}else{var c=d.parents("[data-form-page]").first();if(c.length==1){return c.formular_Page();}}}},getField:function(d){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("getField()");
}if(d.is("[data-form]")){return undefined;}else{if(d.is("[data-form-field]")){return d.formular_Field();}else{var c=d.parents("[data-form-field]").first();if(c.length==1){return c.formular_Field();}}}},isFieldsValid:function(c,f){for(var d=0;d<c.length;d++){var g=c[d];var e=f?g.doValidate(f):g.data.valid;if(!e){return false;}}return true;},toBaseModel:function(d,f,e){var c=e||{};for(var g=0;g<d.length;g++){var h=d[g].getData(f);if(Array.isArray(h)){b.toBaseModel(h,c);}else{if(h&&h.value){c[h.name]=h;}}}return c;}};});})($);(function(a){de.titus.core.Namespace.create("de.titus.form.utils.JQueryFunctions",function(){var b=de.titus.form.utils.JQueryFunctions={};b.ASSOCIATEDELEMENTSELECTOR=(function(e){var d=[];for(var c in e){if(e[c].selector){d.push(e[c].selector);}}return d.join(", ");}(de.titus.form.Constants.STRUCTURELEMENTS));a.fn.formular_utils_RemoveAddClass=function(d,c){if(this.length===0){return;}else{if(this.length>1){this.each(function(){a(this).formular_utils_RemoveAddClass(d,c);
});}else{this.removeClass(d);this.addClass(c);}}return this;};a.fn.formular_utils_SetInitializing=function(){return this.formular_utils_RemoveAddClass("initialized","initializing");};a.fn.formular_utils_SetInitialized=function(){return this.formular_utils_RemoveAddClass("initializing","initialized");};a.fn.formular_utils_SetActive=function(){return this.formular_utils_RemoveAddClass("inactive","active");};a.fn.formular_utils_SetInactive=function(){return this.formular_utils_RemoveAddClass("active","inactive");};a.fn.formular_utils_SetValid=function(){return this.formular_utils_RemoveAddClass("invalid","valid");};a.fn.formular_utils_SetInvalid=function(){return this.formular_utils_RemoveAddClass("valid","invalid");};a.fn.formular_field_utils_getAssociatedStructurElement=function(){if(this.length==1){if(this.is(b.ASSOCIATEDELEMENTSELECTOR)){return this;}else{return this.parent().formular_field_utils_getAssociatedStructurElement();}}};});})($);(function(b,a){de.titus.core.Namespace.create("de.titus.form.Condition",function(){var c=de.titus.form.Condition=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,formular:undefined,dataContext:undefined,expression:(d.attr("data-form-condition")||"").trim(),expressionResolver:new de.titus.core.ExpressionResolver(),timeoutId:undefined};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.Condition");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}if(this.data.expression!==""){this.data.formular=de.titus.form.utils.FormularUtils.getFormular(this.data.element);this.data.dataContext=this.data.element.formular_findDataContext();de.titus.form.utils.EventUtils.handleEvent(this.data.formular.data.element,[a.CONDITION_STATE_CHANGED,a.VALIDATION_STATE_CHANGED,a.FIELD_VALIDATED],c.prototype.__doCondition.bind(this));}de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.INITIALIZED],c.prototype.__doCheck.bind(this));};c.prototype.__doCondition=function(d){if(this.data.timeoutId){clearTimeout(this.data.timeoutId);
}this.data.timeoutId=setTimeout(c.prototype.__doCheck.bind(this,d),100);};c.prototype.__doCheck=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__doCheck("',e,'") -> expression: "',this.data.expression,'", element: "',this.data.element,'", this: "',this,'"']);}e.preventDefault();if(e.type!=a.INITIALIZED&&e.type!=a.FIELD_VALUE_CHANGED){e.stopPropagation();}if(e.currentTarget==this.data.element&&(e.type==a.CONDITION_STATE_CHANGED||e.Type==a.VALIDATION_STATE_CHANGED||aEvebt.type==a.FIELD_VALIDATED)){}else{if(this.data.expression===""){de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.CONDITION_MET);}else{var f=this.data.dataContext.getData({condition:true,validate:false});f=de.titus.form.data.utils.DataUtils.toModel(f,"object");if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__doCheck() -> data: "',f,'", expression: "',this.data.expression,'"']);}var d=this.data.expressionResolver.resolveExpression(this.data.expression,f,false);if(d){de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.CONDITION_MET);
}else{de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.CONDITION_NOT_MET);}}}};de.titus.core.jquery.Components.asComponent("formular_Condition",de.titus.form.Condition);});})($,de.titus.form.Constants.EVENTS);(function(a){de.titus.core.Namespace.create("de.titus.form.DataContext",function(){var b=de.titus.form.DataContext=function(d,c){this.data={element:d,data:c.data,scope:c.scope,parentDataContext:undefined,init:false};};b.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.DataContext");b.prototype.__getParentDataContext=function(){if(!this.data.init){this.data.parentDataContext=this.data.element.formular_findParentDataContext();this.data.init=true;}return this.data.parentDataContext;};b.prototype.getData=function(d){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug('getData ("',d,'")');}var c=this.__getParentDataContext()?this.__getParentDataContext().getData(d):{};var e=typeof this.data.data==="function"?this.data.data(d):this.data.data;if(e){if(this.data.scope){c[this.data.scope]=e;
}else{a.extend(c,e);}}if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug(["getData() -> nativ data: ",c]);}return c;};a.fn.formular_DataContext=function(d){if(this.length==1){var c=this.data("de.titus.form.DataContext");if(!c||d){c=new de.titus.form.DataContext(this,d);this.data("de.titus.form.DataContext",c);this.attr("data-form-data-context","");}return c;}};a.fn.formular_findDataContext=function(){if(this.length==1){if(this.attr("data-form-data-context")!==undefined||this.attr("data-form")!==undefined){return this.formular_DataContext();}else{return this.parent().formular_findDataContext();}}};a.fn.formular_findParentDataContext=function(){if(this.length==1){return this.parent().formular_findDataContext();}};});})($);(function(b,a){de.titus.core.Namespace.create("de.titus.form.Field",function(){var c=de.titus.form.Field={FIELDSELECTORS:[a.SINGLEFIELD.selector,a.CONTAINERFIELD.selector,a.LISTFIELD.selector].join(", ")};b.fn.formular_field_utils_getSubFields=function(){var d=[];this.children().each(function(){var e=b(this);
if(e.is(c.FIELDSELECTORS)){d.push(e.formular_Field());}else{var f=e.formular_field_utils_getSubFields();if(f){Array.prototype.push.apply(d,f);}}});return d;};b.fn.formular_field_utils_getAssociatedField=function(){var d=this.formular_Field();if(d){return d;}return this.parent().formular_field_utils_getAssociatedField();};b.fn.formular_Field=function(){if(this.length===0){return;}else{if(this.length>1){var d=[];this.each(function(){var f=b(this).formular_Field();if(f){d.push(f);}});return d;}else{var e=this.data("de.titus.form.Field");if(!e){if(this.is("[data-form-field]")){e=new de.titus.form.fields.SingleField(this);}else{if(this.is("[data-form-container-field]")){e=new de.titus.form.fields.ContainerField(this);}else{if(this.is("[data-form-list-field]")){e=new de.titus.form.fields.ListField(this);}}}if(e){this.data("de.titus.form.Field",e);}}return e;}}};});})($,de.titus.form.Constants.STRUCTURELEMENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.Message",function(){var c=de.titus.form.Message=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,dataContext:undefined,expression:(d.attr("data-form-message")||"").trim(),expressionResolver:new de.titus.core.ExpressionResolver(),timeoutId:undefined};this.data.element.formular_utils_SetInactive();setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.Message");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}if(this.data.expression!==""){var d=this.data.element.formular_field_utils_getAssociatedStructurElement();this.data.dataContext=this.data.element.formular_findDataContext();de.titus.form.utils.EventUtils.handleEvent(d,[a.INITIALIZED,a.FIELD_VALUE_CHANGED],c.prototype.__doMessage.bind(this));}};c.prototype.__doMessage=function(d){if(this.data.timeoutId){clearTimeout(this.data.timeoutId);}this.data.timeoutId=setTimeout(c.prototype.__doCheck.bind(this,d),300);};c.prototype.__doCheck=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__doCheck("',e,'")']);
}var f=this.data.dataContext.getData({condition:false,validate:true});f=de.titus.form.data.utils.DataUtils.toModel(f,"object");if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__doCheck() -> data context: "',f,'", expression: "',this.data.expression,'"']);}var d=this.data.expressionResolver.resolveExpression(this.data.expression,f,false);if(d){this.data.element.formular_utils_SetActive();}else{this.data.element.formular_utils_SetInactive();}};de.titus.core.jquery.Components.asComponent("formular_Message",de.titus.form.Message);b.fn.formular_initMessages=function(){return this.find("[data-form-message]").formular_Message();};});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.Validation",function(){var c=de.titus.form.Validation=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}var d=e.find("[data-form-validation]").formular_ValidationExpression();this.data={element:e,formular:undefined,dataContext:undefined,field:undefined,expressionResolver:new de.titus.core.ExpressionResolver(),validations:Array.isArray(d)?d:d?[d]:undefined,timeoutId:undefined};
setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.Validation");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}this.data.field=this.data.element.formular_field_utils_getAssociatedField();this.data.dataContext=this.data.element.formular_findDataContext();if(this.data.field.data.required||(this.data.validations&&this.data.validations.length>0)){var d=de.titus.form.utils.FormularUtils.getFormularElement(this.data.element);de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.INITIALIZED,a.FIELD_VALUE_CHANGED],c.prototype.__doLazyValidate.bind(this));de.titus.form.utils.EventUtils.handleEvent(d,[a.CONDITION_STATE_CHANGED,a.VALIDATION_STATE_CHANGED],c.prototype.__doLazyValidate.bind(this));}else{de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.VALIDATION_VALID);}};c.prototype.__doLazyValidate=function(d){if(this.data.timeoutId){clearTimeout(this.data.timeoutId);
}this.data.timeoutId=setTimeout(c.prototype.__handleEvent.bind(this,d),300);};c.prototype.__handleEvent=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__handleEvent("',d,'")']);}d.preventDefault();if(d.type!=a.INITIALIZED&&d.type!=a.FIELD_VALUE_CHANGED){d.stopPropagation();}if(d.currentTarget==this.data.element&&d.Type==a.VALIDATION_STATE_CHANGED){return;}if(this.doValidate()){de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.VALIDATION_VALID);}else{de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.VALIDATION_INVALID);}};c.prototype.doValidate=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("doValidate()");}this.data.element.find("[data-form-validation]").formular_utils_SetInactive();var d=this.data.field.getData({condition:false,validate:true});var e=!this.__valueEmpty(d);if(e){this.data.element.removeClass("no-value");}else{this.data.element.addClass("no-value");}var i=this.data.field.data.condition;var h=this.data.field.data.required;
var g=this.data.field.data.requiredOnActive;var f=this.data.validations&&this.data.validations.length>0;if(!i&&(g||!h)){return true;}else{if(h&&!e){return false;}else{if(e&&f){return this.__checkValidations(d);}else{return true;}}}};c.prototype.__checkValidations=function(f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__checkValidation("',f,'")']);}var g=this.data.dataContext.getData({condition:false,validate:true});g.$value=f?f.value:undefined;g=de.titus.form.data.utils.DataUtils.toModel(g,"object");if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__checkValidation() -> dataContext: "',g,'"']);}for(var e=0;e<this.data.validations.length;e++){var d=this.data.validations[e];if(!d.doValidate(g)){d.data.element.formular_utils_SetActive();return false;}}return true;};c.prototype.__valueEmpty=function(d){return d===undefined||d.value===undefined||(Array.isArray(d.value)&&d.value.length===0)||(typeof d.value==="string"&&d.value.trim().length===0);};de.titus.core.jquery.Components.asComponent("formular_Validation",de.titus.form.Validation);
});})($,de.titus.form.Constants.EVENTS);(function(){de.titus.core.Namespace.create("de.titus.form.ValidationExpression",function(){var a=de.titus.form.ValidationExpression=function(b){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug("constructor");}this.data={element:b,expression:(b.attr("data-form-validation")||"").trim(),expressionResolver:new de.titus.core.ExpressionResolver()};};a.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.ValidationExpression");a.prototype.doValidate=function(b){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug(['doValidate() -> expression: "',this.data.expression,'"']);}if(this.data.expression!==""){return this.data.expressionResolver.resolveExpression(this.data.expression,b,false);}return true;};de.titus.core.jquery.Components.asComponent("formular_ValidationExpression",de.titus.form.ValidationExpression);});})();(function(b,a){de.titus.core.Namespace.create("de.titus.form.Formular",function(){var c=de.titus.form.Formular=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,name:d.attr("data-form"),state:de.titus.form.Constants.STATE.INPUT,expressionResolver:new de.titus.core.ExpressionResolver()};this.data.element.formular_DataContext({data:c.prototype.getData.bind(this)});this.data.element.formular_utils_SetInitializing();setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.Formular");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("init()");}de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.ACTION_SUBMIT],c.prototype.submit.bind(this));this.data.element.formular_StepPanel();this.data.element.formular_FormularControls();this.data.element.formular_PageController();this.data.element.formular_initMessages();setTimeout((function(){de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.INITIALIZED);this.data.element.formular_utils_SetInitialized();}).bind(this),100);};c.prototype.getData=function(g,f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['getData ("',g,'", "',f,'")']);
}var e={};var d=this.data.element.formular_PageController().data.pages;for(var h=0;h<d.length;h++){var j=d[h].getData(g);if(j){e=b.extend(e,j);}}if(f){e=de.titus.form.data.utils.DataUtils.toModel(e,f);}if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['getData ("',g,'", "',f,'") -> result: "',e,'"']);}return e;};c.prototype.submit=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("submit ()");}try{console.log("object model: ");console.log(this.getData("object"));console.log("key-value model: ");console.log(this.getData("key-value"));console.log("list-model model: ");console.log(this.getData("list-model"));console.log("data-model model: ");console.log(this.getData("data-model"));this.data.state=de.titus.form.Constants.STATE.SUBMITTED;de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.STATE_CHANGED);de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.SUCCESSED);}catch(d){c.LOGGER.logError(d);de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.FAILED);
}};});de.titus.core.jquery.Components.asComponent("Formular",de.titus.form.Formular);b(document).ready(function(){b("[data-form]").Formular();});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.FormularControls",function(){var c=de.titus.form.FormularControls=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}this.data={element:d};this.init();};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.FormularControls");c.prototype.init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("init()");}this.data.element.find("[data-form-button-reset]").formular_buttons_ResetButton();this.data.element.find("[data-form-button-back]").formular_buttons_BackButton();this.data.element.find("[data-form-button-next]").formular_buttons_NextButton();this.data.element.find("[data-form-button-summary]").formular_buttons_SummaryButton();this.data.element.find("[data-form-button-submit]").formular_buttons_SubmitButton();
};de.titus.core.jquery.Components.asComponent("formular_FormularControls",de.titus.form.FormularControls);});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.Page",function(){var c=de.titus.form.Page=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}this.data={element:d,formular:undefined,dataContext:undefined,type:de.titus.form.Constants.TYPES.PAGE,name:d.attr("data-form-page"),step:(d.attr("data-form-step")||"").trim(),active:false,condition:undefined,valid:undefined,fields:[]};this.data.element.formular_DataContext({data:c.prototype.getData.bind(this),scope:"$page"});setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.Page");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("init()");}this.data.formular=de.titus.form.utils.FormularUtils.getFormular(this.data.element);this.data.dataContext=this.data.element.formular_findParentDataContext();
de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.CONDITION_MET,a.CONDITION_NOT_MET],c.prototype.__changeConditionState.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.CONDITION_STATE_CHANGED,a.VALIDATION_STATE_CHANGED],c.prototype.__changeValidationState.bind(this));this.data.fields=this.data.element.formular_field_utils_getSubFields();this.data.element.formular_Condition();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.PAGE_INITIALIZED);};c.prototype.__changeConditionState=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__changeConditionState ("',d,'") -> page: "',this,'"']);}d.preventDefault();d.stopPropagation();var e=false;if(d.type==a.CONDITION_MET){e=true;}if(this.data.condition!=e){this.data.condition=e;de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.CONDITION_STATE_CHANGED);}};c.prototype.__changeValidationState=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__changeConditionState ("',d,'") -> page: "',this,'"']);
}d.preventDefault();var e=this.doValidate();if(this.data.valid!=e){this.data.valid=e;if(this.data.valid){this.data.element.formular_utils_SetValid();}else{this.data.element.formular_utils_SetInvalid();}de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.VALIDATION_STATE_CHANGED);}};c.prototype.doValidate=function(d){return de.titus.form.utils.FormularUtils.isFieldsValid(this.data.fields,d);};c.prototype.hide=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("hide ()");}this.data.active=false;this.data.element.formular_utils_SetInactive();};c.prototype.show=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("show ()");}if(this.data.condition){this.data.element.formular_utils_SetActive();for(var d=0;d<this.data.fields.length;d++){this.data.fields[d].show();}this.data.active=true;}};c.prototype.summary=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("summary ()");}if(this.data.condition){for(var d=0;d<this.data.fields.length;d++){this.data.fields[d].summary();
}this.data.element.formular_utils_SetActive();}};c.prototype.getData=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['getData("',e,'") -> page: "',this,'"']);}var d;if(e.example){d=de.titus.form.utils.FormularUtils.toBaseModel(this.data.fields,e);}else{if(this.data.active||(this.data.condition&&this.data.valid)){d=de.titus.form.utils.FormularUtils.toBaseModel(this.data.fields,e);}else{return;}}if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['getData() -> result: "',d,'"']);}if(this.data.name){return{name:this.data.name,type:"container-field",$type:"container-field",value:d};}else{return d;}};de.titus.core.jquery.Components.asComponent("formular_Page",de.titus.form.Page);});})($,de.titus.form.Constants.EVENTS);(function(){de.titus.core.Namespace.create("de.titus.form.PageControlHandle",function(){var a=de.titus.form.PageControlHandle=function(d,c,b,e){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug("constructor");}this.data={index:c,page:d,step:b,pageController:e};};a.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.PageControlHandle");
a.prototype.hide=function(){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug("hide ()");}if(this.data.page&&this.data.page.hide){this.data.page.hide();}};a.prototype.show=function(){if(a.LOGGER.isDebugEnabled()){a.LOGGER.logDebug("show ()");}if(this.data.page&&this.data.page.show){this.data.page.show();}};});})($);(function(b,a){de.titus.core.Namespace.create("de.titus.form.PageController",function(){var c=de.titus.form.PageController=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}this.data={element:d,pages:[],pageHandles:[],currentHandle:undefined};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.PageController");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}var d=this.data.element;this.data.pages=this.data.element.find("[data-form-page]").formular_Page();if(typeof this.data.pages==="undefined"){this.data.pages=[];}else{if(!Array.isArray(this.data.pages)){this.data.pages=[this.data.pages];
}}this.data.pageHandles=this.__initPageHandles();de.titus.form.utils.EventUtils.handleEvent(this.data.element,a.ACTION_PAGE_BACK,c.prototype.toPrevPage.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.ACTION_PAGE_NEXT,a.ACTION_SUMMARY,a.ACTION_SUBMIT],c.prototype.toNextPage.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.element,a.CONDITION_STATE_CHANGED,c.prototype.__checkCurrentPage.bind(this));};c.prototype.__initPageHandles=function(){var h=[];var f=0;var j=de.titus.form.Constants.SPECIALSTEPS.START;for(var g=0;g<this.data.pages.length;g++){var l=this.data.pages[g];if(l.data.step!==""){j=l.data.step;}else{l.data.step=j;}l.hide();var k=new de.titus.form.PageControlHandle(l,g,j,this);h.push(k);}var e=new de.titus.form.page.utils.VirtualPage(this.data.element,{pageController:this,type:de.titus.form.Constants.TYPES.SUMMARY_PAGE,step:de.titus.form.Constants.SPECIALSTEPS.SUMMARY,event:a.PAGE_SUMMARY});h.push(new de.titus.form.PageControlHandle(e,h.length,e.data.step,this));
var d=new de.titus.form.page.utils.VirtualPage(this.data.element,{pageController:this,type:de.titus.form.Constants.TYPES.SUBMITTED_PAGE,step:de.titus.form.Constants.SPECIALSTEPS.SUBMITTED,event:a.PAGE_SUBMITTED});h.push(new de.titus.form.PageControlHandle(d,h.length,d.data.step,this));return h;};c.prototype.__checkCurrentPage=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__checkCurrentPage()");}if(!this.data.currentHandle&&this.data.pageHandles[0].data.page.data.condition){this.__toPageHandle(this.data.pageHandles[0]);}};c.prototype.isFirstPage=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("isFirstPage()");}return this.data.currentHandle&&this.data.currentHandle.data.index===0;};c.prototype.getCurrentPage=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("getCurrentPage()");}if(this.data.currentHandle){return this.data.currentHandle.data.page;}};c.prototype.getNextPage=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("getNextPage()");}return this.__getNextPageHandle().data.page;
};c.prototype.hasNextPage=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("hasNextPage()");}return this.__getNextPageHandle()!==undefined;};c.prototype.__getNextPageHandle=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__getNextPageHandle()");}if(!this.data.currentHandle){return;}else{if(!this.data.currentHandle.data.page.doValidate(true)){return this.data.currentHandle;}else{for(var d=this.data.currentHandle.data.index+1;d<this.data.pageHandles.length;d++){var e=this.data.pageHandles[d];if(e.data.page.data.condition){return e;}}return this.data.currentHandle;}}};c.prototype.__getPrevPageHandle=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__getPrevPageHandle()");}if(!this.data.currentHandle){return this.data.pageHandles[0];}else{for(var d=this.data.currentHandle.data.index-1;0<=d;d--){var e=this.data.pageHandles[d];if(e.data.page.data.condition){return e;}}return this.data.currentHandle;}};c.prototype.__toPageHandle=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__toPage()");
}if(d){if(this.data.currentHandle){this.data.element.removeClass("step-"+this.data.currentHandle.data.step);this.data.currentHandle.hide();}this.data.currentHandle=d;this.data.element.addClass("step-"+this.data.currentHandle.data.step);this.data.currentHandle.show();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.PAGE_CHANGED);}};c.prototype.toPrevPage=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("toPrevPage()");}var d=this.__getPrevPageHandle();if(d){this.__toPageHandle(d);}};c.prototype.toNextPage=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("toNextPage()");}var d=this.__getNextPageHandle();if(d){this.__toPageHandle(d);}};de.titus.core.jquery.Components.asComponent("formular_PageController",de.titus.form.PageController);});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.StepPanel",function(){var c=de.titus.form.StepPanel=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,panelElement:d.find("[data-form-step-panel]"),steps:[],current:undefined};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.StepPanel");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("init()");}var d=[];var e=0;this.data.panelElement.find("[data-form-step]").each(function(){var f=b(this);f.formular_utils_SetInactive();var g={index:e++,id:f.attr("data-form-step").toLowerCase(),element:f};d.push(g);});this.data.steps=d;de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.EVENTS.STATE_CHANGED,a.EVENTS.PAGE_CHANGED],c.prototype.update.bind(this));};c.prototype.update=function(f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("update() -> "+f.type);}var e=this.data.element.Formular();var d=this.data.element.formular_PageController();var g=e.data.state;var h=a.SPECIALSTEPS.START;if(g==a.STATE.INPUT&&d.getCurrentPage()){h=d.getCurrentPage().data.step;}else{if(g==a.STATE.SUMMARY){h=a.SPECIALSTEPS.SUMMARY;
}else{if(g==a.STATE.SUBMITTED){h=a.SPECIALSTEPS.SUBMITTED;}}}this.setStep(h);};c.prototype.setStep=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug('setStep("'+e+'")');}var d=this.getStep(e);if(d!==undefined){if(this.data.current){this.data.current.element.formular_utils_SetInactive();this.data.element.removeClass("step-"+this.data.current.id);}this.data.current=d;this.data.current.element.formular_utils_SetActive();this.data.element.addClass("step-"+e);}};c.prototype.getStep=function(f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug('getStep("'+f+'")');}if(!f){return;}var g=f.toLowerCase();for(var d=0;d<this.data.steps.length;d++){var e=this.data.steps[d];if(e.id==g){return e;}}};de.titus.core.jquery.Components.asComponent("formular_StepPanel",de.titus.form.StepPanel);});})($,de.titus.form.Constants);(function(b,a){de.titus.core.Namespace.create("de.titus.form.buttons.BackButton",function(){var c=de.titus.form.buttons.BackButton=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,formularElement:de.titus.form.utils.FormularUtils.getFormularElement(d)};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.buttons.BackButton");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}de.titus.form.utils.EventUtils.handleEvent(this.data.element,"click",c.prototype.execute.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.formularElement,[a.PAGE_CHANGED],c.prototype.update.bind(this));this.data.element.formular_utils_SetInactive();};c.prototype.execute=function(d){d.preventDefault();d.stopPropagation();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.ACTION_PAGE_BACK);};c.prototype.update=function(f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("update() -> "+f.type);}var e=this.data.formularElement.Formular();if(e.data.state!=de.titus.form.Constants.STATE.SUBMITTED){var d=this.data.formularElement.formular_PageController();
if(!d.isFirstPage()){return this.data.element.formular_utils_SetActive();}}this.data.element.formular_utils_SetInactive();};de.titus.core.jquery.Components.asComponent("formular_buttons_BackButton",de.titus.form.buttons.BackButton);});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.buttons.NextButton",function(){var c=de.titus.form.buttons.NextButton=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}this.data={element:d,formularElement:de.titus.form.utils.FormularUtils.getFormularElement(d)};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.buttons.NextButton");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}de.titus.form.utils.EventUtils.handleEvent(this.data.element,"click",c.prototype.execute.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.formularElement,[a.PAGE_CHANGED,a.VALIDATION_STATE_CHANGED],c.prototype.update.bind(this));
this.data.element.formular_utils_SetInactive();};c.prototype.execute=function(d){d.preventDefault();d.stopPropagation();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.ACTION_PAGE_NEXT);};c.prototype.update=function(f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("update() -> "+f.type);}var e=this.data.formularElement.formular_PageController();var g=e.getCurrentPage();if(g&&g.data.type==de.titus.form.Constants.TYPES.PAGE&&g.data.condition&&g.data.valid){var d=e.getNextPage();if(d.data.type==de.titus.form.Constants.TYPES.PAGE){return this.data.element.formular_utils_SetActive();}}this.data.element.formular_utils_SetInactive();};de.titus.core.jquery.Components.asComponent("formular_buttons_NextButton",de.titus.form.buttons.NextButton);});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.buttons.ResetButton",function(){var c=de.titus.form.buttons.ResetButton=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,formularElement:de.titus.form.utils.FormularUtils.getFormularElement(d)};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.buttons.ResetButton");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("init()");}de.titus.form.utils.EventUtils.handleEvent(this.data.element,"click",c.prototype.execute.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.formularElement,[a.ACTION_SUBMIT],c.prototype.update.bind(this));this.data.element.formular_utils_SetActive();};c.prototype.execute=function(d){d.preventDefault();d.stopPropagation();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.ACTION_RESET);};c.prototype.update=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("update() -> "+d.type);}this.data.element.formular_utils_SetInactive();};de.titus.core.jquery.Components.asComponent("formular_buttons_ResetButton",de.titus.form.buttons.ResetButton);
});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.buttons.SubmitButton",function(){var c=de.titus.form.buttons.SubmitButton=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}this.data={element:d,formularElement:de.titus.form.utils.FormularUtils.getFormularElement(d)};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.buttons.SubmitButton");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");}de.titus.form.utils.EventUtils.handleEvent(this.data.element,"click",c.prototype.execute.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.formularElement,[a.PAGE_CHANGED],c.prototype.update.bind(this));this.data.element.formular_utils_SetInactive();};c.prototype.execute=function(d){d.preventDefault();d.stopPropagation();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.ACTION_SUBMIT);
};c.prototype.update=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("update() -> "+e.type);}var d=this.data.formularElement.formular_PageController();var f=d.getCurrentPage();if(f.data.type==de.titus.form.Constants.TYPES.SUMMARY_PAGE){this.data.element.formular_utils_SetActive();}else{this.data.element.formular_utils_SetInactive();}};de.titus.core.jquery.Components.asComponent("formular_buttons_SubmitButton",de.titus.form.buttons.SubmitButton);});})($,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.buttons.SummaryButton",function(){var c=de.titus.form.buttons.SummaryButton=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");}this.data={element:d,formularElement:de.titus.form.utils.FormularUtils.getFormularElement(d)};setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.buttons.SummaryButton");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("__init()");
}de.titus.form.utils.EventUtils.handleEvent(this.data.element,"click",c.prototype.execute.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.formularElement,[a.PAGE_CHANGED,a.VALIDATION_STATE_CHANGED],c.prototype.update.bind(this));this.data.element.formular_utils_SetInactive();};c.prototype.execute=function(d){d.preventDefault();d.stopPropagation();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.ACTION_SUMMARY);};c.prototype.update=function(f){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("update() -> "+f.type);}var e=this.data.formularElement.formular_PageController();var g=e.getCurrentPage();if(g&&g.data.condition&&g.data.valid){var d=e.getNextPage();if(d.data.type==de.titus.form.Constants.TYPES.SUMMARY_PAGE){return this.data.element.formular_utils_SetActive();}}this.data.element.formular_utils_SetInactive();};de.titus.core.jquery.Components.asComponent("formular_buttons_SummaryButton",de.titus.form.buttons.SummaryButton);});})($,de.titus.form.Constants.EVENTS);
(function(a){de.titus.core.Namespace.create("de.titus.form.data.utils.DataUtils",function(){var b=de.titus.form.data.utils.DataUtils={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.data.utils.DataUtils"),toModel:function(e,c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug(['toModel ("',e,'", "',c,'")']);}var d=c.toLowerCase().trim();if(typeof b[d]==="function"){return b[d](e);}return e;}};});})($);(function(a){de.titus.core.Namespace.create("de.titus.form.data.utils.ObjectModel",function(){var b=de.titus.form.data.utils.ObjectModel={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.data.utils.ObjectModel"),toModel:function(e){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug(['toModel("',e,'"']);}if(e===undefined){return;}var c;if(typeof e.$type==="string"){if(e.$type=="single-field"){return e.value;}else{return b.toModel(e.value);}}else{if(Array.isArray(e)){c=[];for(var f=0;f<e.length;f++){c.push(b.toModel(e[f]));}}else{if(typeof e==="object"){c={};
for(var d in e){c[d]=b.toModel(e[d]);}}else{return e;}}}return c;}};a.extend(de.titus.form.data.utils.DataUtils,{"object":b.toModel});});})($);(function(a){de.titus.core.Namespace.create("de.titus.form.field.controller.DefaultController",function(){var b=de.titus.form.field.controller.DefaultController=function(c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("constructor");}this.element=c;this.input=undefined;this.type=undefined;this.filedata=undefined;this.timeoutId=undefined;this.data={type:undefined};this.__init();};b.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.field.controller.DefaultController");b.prototype.valueChanged=function(c){c.preventDefault();c.stopPropagation();de.titus.form.utils.EventUtils.triggerEvent(this.element,de.titus.form.Constants.EVENTS.FIELD_VALUE_CHANGED);};b.prototype.__init=function(){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("init()");}if(this.element.find("select").length==1){this.type="select";this.element.find("select").on("change",b.prototype.valueChanged.bind(this));
}else{if(this.element.find("input[type='radio']").length>0){this.type="radio";this.element.find("input[type='radio']").on("change",b.prototype.valueChanged.bind(this));}else{if(this.element.find("input[type='checkbox']").length>0){this.type="checkbox";this.element.find("input[type='checkbox']").on("change",b.prototype.valueChanged.bind(this));}else{if(this.element.find("input[type='file']").length==1){this.type="file";this.element.find("input[type='file']").on("change",b.prototype.readFileData.bind(this));}else{this.type="text";this.element.find("input, textarea").on("keyup change",(function(c){if(this.timeoutId!==undefined){window.clearTimeout(this.timeoutId);}this.timeoutId=window.setTimeout((function(){this.valueChanged(c);}).bind(this),300);}).bind(this));}}}this.data.type=this.type;}de.titus.form.utils.EventUtils.handleEvent(this.element,de.titus.form.Constants.EVENTS.FIELD_SHOW,(function(){if(this.type=="select"){this.element.find("select").prop("disabled",false);}else{this.element.find("input, textarea").prop("disabled",false);
}}).bind(this));de.titus.form.utils.EventUtils.handleEvent(this.element,de.titus.form.Constants.EVENTS.FIELD_SUMMARY,(function(){if(this.type=="select"){this.element.find("select").prop("disabled",true);}else{this.element.find("input, textarea").prop("disabled",true);}}).bind(this));if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("init() -> detect type: "+this.type);}};b.prototype.readFileData=function(j){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("readFileData()");}var g=j.target;var d=g.files.length>1;if(d){this.fileData=[];}else{this.fileData=undefined;}var f=this;var c=new FileReader();var k=g.files.length;c.addEventListener("load",(function(){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("readFileData() -> reader load event!");}k--;if(d){this.fileData.push(c.result);}else{this.fileData=c.result;}if(k===0){de.titus.form.utils.EventUtils.triggerEvent(this.element,de.titus.form.Constants.EVENTS.FIELD_VALUE_CHANGED);}}).bind(this),false);var e=this.element.find("input[type='text'][readonly]");
if(e.length==1){e.val("");}for(var h=0;h<g.files.length;h++){c.readAsDataURL(g.files[h]);if(e.length==1){e.val(e.val()!==""?e.val()+", "+g.files[h].name:g.files[h].name);}}};b.prototype.getValue=function(){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("getValue()");}var d;if(this.type=="select"){d=this.element.find("select").val();if(d&&d.length>0){return d;}}else{if(this.type=="radio"){d=this.element.find("input:checked").val();if(d&&d.trim()!==""){return d;}}else{if(this.type=="checkbox"){var c=[];this.element.find("input:checked").each(function(){var e=a(this).val();if(e&&e.trim()!==""){c.push(e);}});return c.length>0?c:undefined;}else{if(this.type=="file"){return this.fileData;}else{d=this.element.find("input, textarea").first().val();if(d&&d.trim()!==""){return d;}}}}}};de.titus.form.Registry.registFieldController("default",function(c){return new b(c);});});})($);(function(b,c,a){de.titus.core.Namespace.create("de.titus.form.fields.ContainerField",function(){var d=de.titus.form.fields.ContainerField=function(e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("constructor");
}this.data={element:e,dataContext:undefined,name:(e.attr("data-form-container-field")||"").trim(),active:false,required:(e.attr("data-form-required")!==undefined),requiredOnActive:(e.attr("data-form-required")==="on-condition-true"),condition:undefined,valid:undefined,fields:[]};this.data.element.formular_DataContext({data:d.prototype.getData.bind(this),scope:"$container"});this.hide();setTimeout(d.prototype.__init.bind(this),1);};d.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.fields.ContainerField");d.prototype.__init=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("init()");}this.data.dataContext=this.data.element.formular_findParentDataContext();c.handleEvent(this.data.element,[a.CONDITION_MET,a.CONDITION_NOT_MET],d.prototype.__changeConditionState.bind(this));c.handleEvent(this.data.element,[a.CONDITION_STATE_CHANGED,a.VALIDATION_STATE_CHANGED],d.prototype.__handleValidationEvent.bind(this),"*");this.data.fields=this.data.element.formular_field_utils_getSubFields();
this.data.element.formular_Condition();c.triggerEvent(this.data.element,a.INITIALIZED);};d.prototype.__changeConditionState=function(e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug(['__changeConditionState()  for "',this.data.name,'" -> ',e]);}e.preventDefault();e.stopPropagation();var f=false;if(e.type==a.CONDITION_MET){f=true;}if(this.data.condition!=f){this.data.condition=f;if(this.data.condition){this.show();}else{this.hide();}c.triggerEvent(this.data.element,a.CONDITION_STATE_CHANGED);}};d.prototype.__handleValidationEvent=function(e){this.doValidation(true);};d.prototype.doValidation=function(f){if(f){var e=this.data.valid;this.data.valid=de.titus.form.utils.FormularUtils.isFieldsValid(this.data.fields,f);if(e!=this.data.valid){if(this.data.valid){this.data.element.formular_utils_SetValid();}else{this.data.element.formular_utils_SetInvalid();}}}return this.data.valid;};d.prototype.hide=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("hide ()");}this.data.active=false;
this.data.element.formular_utils_SetInactive();for(var e=0;e<this.data.fields.length;e++){this.data.fields[e].hide();}};d.prototype.show=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("show ()");}if(this.data.condition){this.data.element.formular_utils_SetActive();for(var e=0;e<this.data.fields.length;e++){this.data.fields[e].show();}this.data.active=true;}};d.prototype.summary=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("summary ()");}if(this.data.condition){for(var e=0;e<this.data.fields.length;e++){this.data.fields[e].summary();}this.data.element.formular_utils_SetActive();}};d.prototype.getData=function(f){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug('getData("',f,'")');}var e;if(f.example){e=de.titus.form.utils.FormularUtils.toBaseModel(this.data.fields,f);}else{if(this.data.condition&&(this.data.active||(this.data.condition&&this.data.valid))){e=de.titus.form.utils.FormularUtils.toBaseModel(this.data.fields,f);}else{return;}}if(this.data.name){return{name:this.data.name,type:"container-field",$type:"container-field",value:e};
}else{return e;}};});})($,de.titus.form.utils.EventUtils,de.titus.form.Constants.EVENTS);(function(b,c,a){de.titus.core.Namespace.create("de.titus.form.fields.ListField",function(){var d=de.titus.form.fields.ListField=function(e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("constructor");}this.data={element:e,dataContext:undefined,name:(e.attr("data-form-list-field")||"").trim(),template:e.find("[data-form-content-template]").detach(),contentContainer:e.find("[data-form-content-container]"),addButton:e.find("[data-form-list-field-action-add]"),required:(e.attr("data-form-required")!==undefined),requiredOnActive:(e.attr("data-form-required")==="on-condition-true"),min:parseInt(e.attr("data-form-list-field-min")||"0"),max:parseInt(e.attr("data-form-list-field-max")||"0"),condition:undefined,valid:undefined,items:[]};this.data.element.formular_DataContext({data:d.prototype.getData.bind(this),scope:"$list"});this.hide();setTimeout(d.prototype.__init.bind(this),1);};d.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.fields.ListField");
d.prototype.__init=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("init()");}this.data.dataContext=this.data.element.formular_findParentDataContext();c.handleEvent(this.data.element,[a.CONDITION_MET,a.CONDITION_NOT_MET],d.prototype.__changeConditionState.bind(this));c.handleEvent(this.data.element,[a.CONDITION_STATE_CHANGED,a.VALIDATION_STATE_CHANGED,a.FIELD_VALUE_CHANGED],d.prototype.__handleValidationEvent.bind(this),"*");this.data.element.formular_Condition();c.handleEvent(this.data.addButton,["click"],d.prototype.__addItem.bind(this));c.triggerEvent(this.data.element,a.INITIALIZED);this.doValidate();};d.prototype.__addItem=function(e){var f={id:("item-"+de.titus.core.UUID()),index:this.data.items.length,element:this.data.template.clone(),field:undefined};f.element=this.data.template.clone();f.element.attr("id",f.id);f.element.attr("data-form-list-item",f.id);if(f.element.attr("data-form-container-field")===undefined){f.element.attr("data-form-container-field","item");}f.element.formular_utils_SetInitializing();
this.data.items.push(f);f.element.appendTo(this.data.contentContainer);c.handleEvent(f.element.find("[data-form-list-field-action-remove]"),["click"],d.prototype.__removeItem.bind(this));setTimeout(d.prototype.__initializeItem.bind(this,f),1);};d.prototype.__initializeItem=function(e){e.field=e.element.formular_Field();e.element.formular_DataContext({data:(function(f){var g=this.field.getData(f);if(g){return g.value;}}).bind(e),scope:"$item"});e.element.formular_initMessages();e.element.formular_utils_SetInitialized();c.triggerEvent(this.data.element,a.FIELD_VALUE_CHANGED);this.doValidate();this.__doCheckAddButton();};d.prototype.__removeItem=function(g){var j=b(g.target);var f=j.parents("[data-form-list-item]");var k=f.attr("id");for(var e=0;e<this.data.items.length;e++){var h=this.data.items[e];if(h.id==k){this.data.items.splice(e,1);f.remove();c.triggerEvent(this.data.element,a.FIELD_VALUE_CHANGED);this.doValidate();this.__doCheckAddButton();return;}}};d.prototype.__doCheckAddButton=function(){if(this.data.max===0||this.data.items.length<this.data.max){this.data.element.find("[data-form-list-field-action-add]").formular_utils_SetActive();
}else{this.data.element.find("[data-form-list-field-action-add]").formular_utils_SetInactive();}};d.prototype.__changeConditionState=function(e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug(['__changeConditionState()  for "',this.data.name,'" -> ',e]);}e.preventDefault();e.stopPropagation();var f=false;if(e.type==a.CONDITION_MET){f=true;}if(this.data.condition!=f){this.data.condition=f;if(this.data.condition){this.show();}else{this.hide();}c.triggerEvent(this.data.element,a.CONDITION_STATE_CHANGED);}};d.prototype.__handleValidationEvent=function(f){var e=this.data.valid;this.doValidate();if(this.data.valid!=e){c.triggerEvent(this.data.element,a.VALIDATION_STATE_CHANGED);}de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.FIELD_VALIDATED);};d.prototype.doValidate=function(f){var e=this.data.valid;if(this.data.items.length===0){this.data.valid=!this.data.required;}else{if(this.data.items.length<this.data.min){this.data.valid=false;}else{if(this.data.max!==0&&this.data.items.length>this.data.max){this.data.valid=false;
}else{this.data.valid=this.__isListItemsValid();}}}if(e!=this.data.valid){if(this.data.valid){this.data.element.formular_utils_SetValid();}else{this.data.element.formular_utils_SetInvalid();}}return this.data.valid;};d.prototype.__isListItemsValid=function(){for(var e=0;e<this.data.items.length;e++){var f=this.data.items[e];if(!f.field.data.valid){return false;}}return true;};d.prototype.hide=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("hide ()");}this.data.element.formular_utils_SetInactive();for(var e=0;e<this.data.items.length;e++){var f=this.data.items[e];f.field.hide();}};d.prototype.show=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("show ()");}if(this.data.condition){this.data.element.formular_utils_SetActive();for(var e=0;e<this.data.items.length;e++){var f=this.data.items[e];f.field.show();}}this.data.element.find("[data-form-list-field-action-remove]").formular_utils_SetActive();this.__doCheckAddButton();};d.prototype.summary=function(){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("summary ()");
}if(this.data.condition){for(var e=0;e<this.data.items.length;e++){var f=this.data.items[e];f.field.summary();}this.data.element.formular_utils_SetActive();}this.data.element.find("[data-form-list-field-action-remove]").formular_utils_SetInactive();this.data.element.find("[data-form-list-field-action-add]").formular_utils_SetInactive();};d.prototype.getData=function(g){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug('getData("',g,'")');}var e=[];if(g.example){e=d.getExample(g);}else{if(this.data.condition&&(this.data.valid||g.validate||g.condition)){for(var h=0;h<this.data.items.length;h++){var j=this.data.items[h];var f=j.field.getData(g);if(f&&f.value){e.push(f.value);}}}else{return;}}return{name:this.data.name,type:"list-field",$type:"list-field",value:e};};d.prototype.getExample=function(e){};});})($,de.titus.form.utils.EventUtils,de.titus.form.Constants.EVENTS);(function(b,a){de.titus.core.Namespace.create("de.titus.form.fields.SingleField",function(){var c=de.titus.form.fields.SingleField=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("constructor");
}this.data={element:d,dataContext:undefined,name:(d.attr("data-form-field")||"").trim(),type:(d.attr("data-form-field-type")||"default").trim(),required:(d.attr("data-form-required")!==undefined),requiredOnActive:(d.attr("data-form-required")==="on-condition-true"),condition:undefined,valid:undefined,controller:undefined};this.data.element.formular_DataContext({data:c.prototype.getData.bind(this),scope:"$field"});this.hide();setTimeout(c.prototype.__init.bind(this),1);};c.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.form.fields.SingleField");c.prototype.__init=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("init()");}this.data.dataContext=this.data.element.formular_findParentDataContext();this.data.controller=de.titus.form.Registry.getFieldController(this.data.type,this.data.element);de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.CONDITION_MET,a.CONDITION_NOT_MET],c.prototype.__changeConditionState.bind(this));de.titus.form.utils.EventUtils.handleEvent(this.data.element,[a.VALIDATION_VALID,a.VALIDATION_INVALID],c.prototype.__changeValidationState.bind(this));
this.data.element.formular_Condition();this.data.element.formular_Validation();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.INITIALIZED);};c.prototype.__changeConditionState=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug('__changeConditionState()  for "'+this.data.name+'" -> '+d.type);}d.preventDefault();d.stopPropagation();var e=false;if(d.type==a.CONDITION_MET){e=true;}if(this.data.condition!=e){this.data.condition=e;if(this.data.condition){this.show();}else{this.hide();}de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.CONDITION_STATE_CHANGED);}};c.prototype.__changeValidationState=function(d){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['__changeValidationState() for field "',this.data.name,'" -> ',d.type,'; field: "',this,'"']);}d.preventDefault();d.stopPropagation();var e=d.type==a.VALIDATION_VALID;if(this.data.valid!=e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug('__changeValidationState() for field "'+this.data.name+'" from '+this.data.valid+" -> "+e);
}this.data.valid=e;if(this.data.valid){this.data.element.formular_utils_SetValid();}else{this.data.element.formular_utils_SetInvalid();}de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.VALIDATION_STATE_CHANGED);}de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.FIELD_VALIDATED);};c.prototype.doValidate=function(d){if(d){this.data.valid=this.data.element.formular_Validation().doValidate();if(this.data.valid){this.data.element.formular_utils_SetValid();}else{this.data.element.formular_utils_SetInvalid();}}return this.data.valid;};c.prototype.hide=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("hide ()");}this.data.element.formular_utils_SetInactive();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.FIELD_HIDE);};c.prototype.show=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("show ()");}if(this.data.condition){this.data.element.formular_utils_SetActive();de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.FIELD_SHOW);
}};c.prototype.summary=function(){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug("summary ()");}if(this.data.condition){de.titus.form.utils.EventUtils.triggerEvent(this.data.element,a.FIELD_SUMMARY);this.data.element.formular_utils_SetActive();}};c.prototype.getData=function(e){if(c.LOGGER.isDebugEnabled()){c.LOGGER.logDebug(['getData("',e,'")']);}var d;if(e.example){d=this.data.controller.getExample();}else{if(this.data.condition&&(this.data.valid||e.validate||e.condition)){d=this.data.controller.getValue();}else{return;}}return{name:this.data.name,type:this.data.controller.data.type?this.data.controller.data.type:this.data.type,$type:"single-field",value:d};};});})($,de.titus.form.Constants.EVENTS);(function(a){de.titus.core.Namespace.create("de.titus.form.page.utils.VirtualPage",function(){var b=de.titus.form.page.utils.VirtualPage=function(c,d){this.data={element:c,pageController:d.pageController,type:d.type,valid:true,condition:true,step:d.step,event:d.event};};b.prototype.show=function(){var c=this.data.pageController.data.pages;
for(var d=0;d<c.length;d++){c[d].summary();}de.titus.form.utils.EventUtils.triggerEvent(this.data.element,this.data.event);};b.prototype.hide=function(){var c=this.data.pageController.data.pages;for(var d=0;d<c.length;d++){c[d].hide();}};b.prototype.doValidate=function(){return true;};});})($);