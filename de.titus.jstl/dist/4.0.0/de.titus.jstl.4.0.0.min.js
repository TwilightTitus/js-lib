(function(a){de.titus.core.Namespace.create("de.titus.jstl",function(){de.titus.jstl.Version="4.0.0";});})($);de.titus.core.Namespace.create("de.titus.jstl.Constants",function(){de.titus.jstl.Constants={EVENTS:{onStart:"jstl-on-start",onLoad:"jstl-on-load",onSuccess:"jstl-on-success",onFail:"jstl-on-fail",onReady:"jstl-on-ready"},PHASE:{INIT:0,CONDITION:1,CONTEXT:2,MANIPULATION:3,CONTENT:4,CLEANING:5,CHILDREN:6,BINDING:7,FINISH:8}};});(function(b,a){de.titus.jstl.GlobalSettings=b.extend(true,{DEFAULT_TIMEOUT_VALUE:1,DEFAULT_INCLUDE_BASEPATH:""},a);})($,de.titus.jstl.GlobalSettings);de.titus.core.Namespace.create("de.titus.jstl.TaskRegistry",function(){var a={taskchain:undefined};a.append=function(g,c,b,e,f){if(!f&&!a.taskchain){a.taskchain=a.__buildEntry(g,c,b,e);}else{if(!f&&a.taskchain){a.append(g,c,b,e,a.taskchain);}else{if(f.phase<=c&&f.next&&f.next.phase<=c){a.append(g,c,b,e,f.next);}else{if(f.phase<=c&&f.next&&f.next.phase>c){var d=f.next;f.next=a.__buildEntry(g,c,b,e);f.next.next=d;}else{if(f.phase<=c&&!f.next){f.next=a.__buildEntry(g,c,b,e);}else{if(f.phase>c){var d=f;a.taskchain=a.__buildEntry(g,c,b,e);a.taskchain.next=f;}}}}}}};a.__buildEntry=function(e,c,b,d){return{name:e,phase:c,selector:b,task:d};};de.titus.jstl.TaskRegistry=a;});(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.ExecuteChain",function(){let ExecuteChain=de.titus.jstl.ExecuteChain=function(e,d,c){this.count=d||0;this.taskChain=e;this.callback=c;};ExecuteChain.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.ExecuteChain");ExecuteChain.prototype.finish=function(){if(ExecuteChain.LOGGER.isDebugEnabled()){ExecuteChain.LOGGER.logDebug("count: "+this.count);}this.count--;if(this.count==0){if(typeof this.callback==="function"){this.callback(this);}this.taskChain.nextTask();}};});})($,de.titus.jstl.GlobalSettings);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.TaskChain",function(){let TaskChain=function(g,f,e,d,c){this.element=g;this.context=f;this.processor=e;this.root=d;if(typeof c==="function"||Array.isArray(c)){this.callback=c;}this.__preventChilds=false;this.__taskchain=de.titus.jstl.TaskRegistry.taskchain;this.__currentTask=undefined;this.__buildContext();};TaskChain.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.TaskChain");TaskChain.prototype.skipToPhase=function(c){if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug("skipToPhase()");}while(this.__taskchain&&this.__taskchain.phase<c){this.__taskchain=this.__taskchain.next;}return this;};TaskChain.prototype.preventChilds=function(){if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug(["preventChilds() ",this]);}this.__preventChilds=true;return this;};TaskChain.prototype.isPreventChilds=function(){return this.__preventChilds;};TaskChain.prototype.updateContext=function(d,c){if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug("updateContext()");}if(c){this.context=b.extend(this.context,d);}else{this.context=d;}this.__buildContext();return this;};TaskChain.prototype.appendCallback=function(c){if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug("appendCallback()");}if(typeof c!=="function"){return;}if(Array.isArray(this.callback)){this.callback.push(c);}else{if(this.callback){this.callback=[this.callback,c];}else{this.callback=c;}}return this;};TaskChain.prototype.nextTask=function(f,c){if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug(['nextTask( "',f,'", "',c,'")']);}if(typeof f!=="undefined"){if(typeof f!=="object"){throw new Error();}else{this.updateContext(f,c);}}if(this.__taskchain){let name=this.__taskchain.name;let task=this.__taskchain.task;let phase=this.__taskchain.phase;let selector=this.__taskchain.selector;this.__currentTask=this.__taskchain;this.__taskchain=this.__taskchain.next;if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug(['nextTask() -> next task: "',name,'", phase: "',phase,'", selector "',selector,'", element "',this.element,'" !']);}if(selector==undefined||this.element.is(selector)){try{task(this.element,this.context,this.processor,this);}catch(d){TaskChain.LOGGER.logError(d);}}else{if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug(['nextTask() -> skip task: "',name,'", phase: "',phase,'", selector "',selector,'"!']);}this.nextTask();}}else{if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug("nextTask() -> task chain is finished!");}this.finish();}return this;};TaskChain.prototype.__buildContext=function(){this.context["$element"]=this.element;this.context["__element__"]=this.element;this.context["$root"]=this.processor.element;this.context["__root__"]=this.processor.element;return this.context;};TaskChain.prototype.finish=function(c){if(TaskChain.LOGGER.isDebugEnabled()){TaskChain.LOGGER.logDebug("finish()");}if(c){if(typeof this.callback==="function"){this.callback(this.element,this.context,this.processor,this);}else{if(Array.isArray(this.callback)){for(let i=0;i<this.callback.length;i++){if(typeof this.callback[i]==="function"){this.callback[i](this.element,this.context,this.processor,this);}}}}this.element.trigger(de.titus.jstl.Constants.EVENTS.onSuccess,[this.context,this.processor]);}else{let self=this;setTimeout(function(){self.finish(true);},0);}return this;};de.titus.jstl.TaskChain=TaskChain;});})($,de.titus.jstl.GlobalSettings);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.Children",function(){let Children=de.titus.jstl.functions.Children={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Children"),TASK:function(f,e,d,c){if(Children.LOGGER.isDebugEnabled()){Children.LOGGER.logDebug("TASK");}if(!c.isPreventChilds()){let ignoreChilds=f.attr("jstl-ignore-childs");if(typeof ignoreChilds!=="undefined"){if(ignoreChilds.length>0){ignoreChilds=d.resolver.resolveExpression(ignoreChilds,e,true);}else{ignoreChilds=true;}if(ignoreChilds){return c.preventChilds().nextTask();}}let children=f.children();if(children.length==0){c.nextTask();}else{let child=b(children[0]);if(child&&child.length==1){d.compute(child,c.context,function(j,h,g){Children.ElementChain(children,1,c,j,h,g);});}}}else{c.nextTask();}},UpdateContext:function(c,d){c.updateContext(d.context,true);},ElementChain:function(c,d,e,h,g,f){e.updateContext(g,true);if(d<c.length){let next=b(c[d]);if(next&&next.length==1){f.compute(next,e.context,function(l,k,j){Children.ElementChain(c,d+1,e,l,k,j);});}}else{e.nextTask();}}};de.titus.jstl.TaskRegistry.append("children",de.titus.jstl.Constants.PHASE.CHILDREN,undefined,de.titus.jstl.functions.Children.TASK);});})($,de.titus.jstl.GlobalSettings);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.If",function(){let If=de.titus.jstl.functions.If={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.If"),TASK:function(f,e,d,c){if(If.LOGGER.isDebugEnabled()){If.LOGGER.logDebug("TASK");}let expression=f.attr("jstl-if");if(typeof expression!=="undefined"){expression=d.resolver.resolveExpression(expression,e,false);if(typeof expression==="function"){expression=expression(f,e,d);}if(!(expression==true||expression=="true")){f.remove();c.preventChilds().finish();}else{c.nextTask();}}else{c.nextTask();}}};de.titus.jstl.TaskRegistry.append("if",de.titus.jstl.Constants.PHASE.CONDITION,"[jstl-if]",de.titus.jstl.functions.If.TASK);});})($,de.titus.jstl.GlobalSettings);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.Preprocessor",function(){let Preprocessor=de.titus.jstl.functions.Preprocessor={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Preprocessor"),STATICEVENTHANDLER:function(f,d,g,e){if(f&&f!=""){var c=e.resolver.resolveExpression(f,g);if(typeof c==="function"){c(g.$element,g,e);}}},TASK:function(f,e,d,c){if(Preprocessor.LOGGER.isDebugEnabled()){Preprocessor.LOGGER.logDebug("TASK");}if(f[0].nodeType!=1||f.tagName()=="br"){return c.preventChilds().finish();}if(!c.root){let ignore=f.attr("jstl-ignore");if(typeof ignore!=="undefined"){if(ignore.length>0){ignore=d.resolver.resolveExpression(ignore,e,false);}else{ignore=true;}if(ignore){return c.preventChilds().finish();}}let async=f.attr("jstl-async");if(typeof async!=="undefined"){if(async.length>0){async=d.resolver.resolveExpression(async,dataContext,false);}else{async=true;}if(async){d.onReady(function(){f.jstlAsync({data:b.extend({},e)});});return c.preventChilds().finish();}}}Preprocessor.__appendEvents(f);f.trigger(de.titus.jstl.Constants.EVENTS.onLoad,[e,d]);c.nextTask();},__appendEvents:function(c){if(c.attr("jstl-load")){c.one(de.titus.jstl.Constants.EVENTS.onLoad,function(d,f,e){Preprocessor.STATICEVENTHANDLER(c.attr("jstl-load"),d,f,e);});}if(c.attr("jstl-success")){c.one(de.titus.jstl.Constants.EVENTS.onSuccess,function(d,f,e){Preprocessor.STATICEVENTHANDLER(c.attr("jstl-success"),d,f,e);});}}};de.titus.jstl.TaskRegistry.append("preprocessor",de.titus.jstl.Constants.PHASE.INIT,undefined,de.titus.jstl.functions.Preprocessor.TASK);});})($,de.titus.jstl.GlobalSettings);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.ScreenCondition",function(){let ScreenCondition=de.titus.jstl.functions.ScreenCondition={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.ScreenCondition"),TASK:function(f,e,d,c){if(ScreenCondition.LOGGER.isDebugEnabled()){ScreenCondition.LOGGER.logDebug("TASK");}if(typeof f.attr("jstl-screen-condition-init")==="undefined"){f.addClass("jstl-screen-inactive");de.titus.core.ScreenObserver.addHandler({"condition":f.attr("jstl-screen-condition"),"activate":function(g){if(ScreenCondition.LOGGER.isDebugEnabled()){ScreenCondition.LOGGER.logDebug("run jstl screen condition (activate)");}if(!f.is(".jstl-ready")){f.jstl({"data":e,"callback":function(){f.removeClass("jstl-screen-inactive");f.addClass("jstl-screen-active");}});}else{f.removeClass("jstl-screen-inactive");f.addClass("jstl-screen-active");
}},"deactivate":function(g){if(ScreenCondition.LOGGER.isDebugEnabled()){ScreenCondition.LOGGER.logDebug("run jstl screen condition (deactivate)");}f.removeClass("jstl-screen-active");f.addClass("jstl-screen-inactive");}});f.attr("jstl-screen-condition-init","");c.finish();}else{c.nextTask();}}};de.titus.jstl.TaskRegistry.append("screenCondition",de.titus.jstl.Constants.PHASE.INIT,"[jstl-screen-condition]",de.titus.jstl.functions.ScreenCondition.TASK);});})($,de.titus.jstl.GlobalSettings);(function(a){de.titus.core.Namespace.create("de.titus.jstl.functions.Choose",function(){let Choose=de.titus.jstl.functions.Choose={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Choose"),TASK:function(e,d,c,b){if(Choose.LOGGER.isDebugEnabled()){Choose.LOGGER.logDebug("execute run("+e+", "+d+", "+c+")");}let expression=e.attr("jstl-choose");if(typeof expression!=="undefined"){Choose.__compute(e,d,c,c.resolver);b.preventChilds();}b.nextTask();},__compute:function(c,f,e,d){if(Choose.LOGGER.isDebugEnabled()){Choose.LOGGER.logDebug("execute processChilds("+c+", "+f+", "+e+", "+d+")");}var b=false;c.children().each(function(){var g=a(this);if(!b&&Choose.__computeChild(c,g,f,e,d)){if(Choose.LOGGER.isTraceEnabled()){Choose.LOGGER.logTrace("compute child: "+g);}e.compute(g,f);b=true;}else{if(Choose.LOGGER.isTraceEnabled()){Choose.LOGGER.logTrace("remove child: "+g);}g.remove();}});},__computeChild:function(b,f,e,d,c){if(Choose.LOGGER.isDebugEnabled()){Choose.LOGGER.logDebug("execute processChild("+b+", "+f+", "+e+", "+d+", "+c+")");}if(Choose.__computeWhen(b,f,e,d,c)){return true;}else{if(Choose.__computeOtherwise(b,f,e,d,c)){return true;}else{return false;}}},__computeWhen:function(b,f,e,d,c){if(Choose.LOGGER.isDebugEnabled()){Choose.LOGGER.logDebug("execute processWhenElement("+b+", "+f+", "+e+", "+d+", "+c+")");}let expression=f.attr("jstl-when");if(typeof expression!=="undefined"){return c.resolveExpression(expression,e,false);}return false;},__computeOtherwise:function(b,f,e,d,c){if(Choose.LOGGER.isDebugEnabled()){Choose.LOGGER.logDebug("execute processOtherwiseElement("+b+", "+f+", "+e+", "+d+", "+c+")");}if(typeof f.attr("jstl-otherwise")!=="undefined"){return true;}return false;}};de.titus.jstl.TaskRegistry.append("choose",de.titus.jstl.Constants.PHASE.CONDITION,"[jstl-choose]",de.titus.jstl.functions.Choose.TASK);});})($);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.Foreach",function(){let Foreach=de.titus.jstl.functions.Foreach={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Foreach"),TASK:function(f,e,d,c){if(Foreach.LOGGER.isDebugEnabled()){Foreach.LOGGER.logDebug("execute run("+f+", "+e+", "+d+")");}let expression=f.attr("jstl-foreach");if(expression!==undefined){c.preventChilds();Foreach.__compute(expression,f,e,d,d.resolver,c);}else{c.nextTask();}},__compute:function(g,j,h,f,c,e){if(Foreach.LOGGER.isDebugEnabled()){Foreach.LOGGER.logDebug("execute __compute("+j+", "+h+", "+f+", "+c+")");}var d=Foreach.__template(j);if(typeof d!=="undefined"){j.empty();let varName=j.attr("jstl-foreach-var")||"itemVar";let statusName=j.attr("jstl-foreach-status")||"statusVar";if(g.length==0&&typeof j.attr("jstl-foreach-count")!=="undefined"){Foreach.__count(d,statusName,j,h,f,e);}else{let list=c.resolveExpression(g,h,undefined);if(Array.isArray(list)){Foreach.__list(list,d,varName,statusName,j,h,f,e);}else{if(typeof list==="object"){Foreach.__map(list,d,varName,statusName,j,h,f,e);}else{if(typeof list==="undefined"){Foreach.__map(h,d,varName,statusName,j,h,f,e);}else{e.nextTask();}}}}}},__count:function(g,k,h,e,f,m){var l=f.resolver.resolveExpression(h.attr("jstl-foreach-start-index"),e,0)||0;var j=f.resolver.resolveExpression(h.attr("jstl-foreach-count"));var d=typeof h.attr("jstl-foreach-step")!=="undefined"?f.resolver.resolveExpression(h.attr("jstl-foreach-step")):1;var c=new de.titus.jstl.ExecuteChain(m);for(let i=l;i<j;i+=d){let context={};context=b.extend(context,e);context[k]={"index":i,"count":j,"context":e};c.count++;Foreach.__computeContent(g.clone(),context,h,f,c);}},__list:function(g,j,d,l,k,e,f,n){var m=f.resolver.resolveExpression(k.attr("jstl-foreach-start-index"),e,0)||0;var h=k.attr("jstl-foreach-break-condition");var c=new de.titus.jstl.ExecuteChain(n,1);for(let i=m;i<g.length;i++){let context={};context=b.extend(context,e);context[d]=g[i];context[l]={"index":i,"number":(i+1),"count":g.length,"data":g,"context":e};if(h&&Foreach.__break(context,h,k,f)){return c.finish();}else{c.count++;Foreach.__computeContent(j.clone(),context,k,f,c);}}c.finish();},__map:function(m,h,d,l,j,e,f,n){var g=j.attr("jstl-foreach-break-condition");var c=new de.titus.jstl.ExecuteChain(n,1);var k=Object.getOwnPropertyNames(m);for(let i=0;i<k.length;i++){let name=k[i];let context={};context=b.extend(context,e);context[d]=m[name];context[l]={"index":i,"number":(i+1),"key":name,"data":m,"context":e};if(g&&Foreach.__break(context,g,j,f)){return c.finish();}else{c.count++;Foreach.__computeContent(h.clone(),context,j,f,c);}}c.finish();},__break:function(f,c,e,d){var g=d.resolver.resolveExpression(c,f,false);if(typeof g==="function"){g=g(e,f,d);}return g==true||g=="true";},__computeContent:function(g,f,e,d,c){g.appendTo(e);d.compute(g,f,function(){c.finish();});},__template:function(d){var c=d.data("de.titus.jstl.functions.Foreach.Template");if(typeof c==="undefined"){c=b("<jstl/>").append(d.contents());d.data("de.titus.jstl.functions.Foreach.Template",c);}return c;}};de.titus.jstl.TaskRegistry.append("foreach",de.titus.jstl.Constants.PHASE.MANIPULATION,"[jstl-foreach]",de.titus.jstl.functions.Foreach.TASK);});})($,de.titus.jstl.GlobalSettings);(function(a){de.titus.core.Namespace.create("de.titus.jstl.functions.Text",function(){let Text=de.titus.jstl.functions.Text={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Text"),TASK:function(f,e,d,c){if(Text.LOGGER.isDebugEnabled()){Text.LOGGER.logDebug("execute run("+f+", "+e+", "+d+")");}let ignore=f.attr("jstl-text-ignore");if(typeof ignore==="undefined"){if(!de.titus.core.Page.getInstance().detectBrowser().other){Text.normalize(f[0]);}var b=f.attr("jstl-text-content-type")||"text";f.contents().filter(function(){return(this.nodeType===3||this.nodeType===4)&&this.textContent!=undefined&&this.textContent.trim()!="";}).each(function(){let text=this.textContent;if(text){text=d.resolver.resolveText(text,e);let contentFunction=Text.CONTENTTYPE[b];if(contentFunction){contentFunction(this,text,f,d,e);}}});}c.nextTask();},normalize:function(b){if(b){if(b.nodeType==3){var c=b.textContent;while(b.nextSibling&&b.nextSibling.nodeType==3){c+=b.nextSibling.textContent;b.parentNode.removeChild(b.nextSibling);}b.textContent=c;}else{Text.normalize(b.firstChild);}Text.normalize(b.nextSibling);}},CONTENTTYPE:{"html":function(b,c,f,d,e){a(b).replaceWith(a.parseHTML(c));},"json":function(b,c,f,d,e){if(typeof c==="string"){b.textContent=c;}else{b.textContent=JSON.stringify(c);}},"text":function(c,g,k,e,d){var h=g;var j=false;var f=k.attr("jstl-text-trim-length");if(f!=undefined&&f!=""){f=e.resolver.resolveExpression(f,d,"-1");f=parseInt(f);if(f&&f>0){h=de.titus.core.StringUtils.trimTextLength(h,f);}}var b=k.attr("jstl-text-prevent-format");if(b){b=e.resolver.resolveExpression(b,d,true)||true;if(b){h=de.titus.core.StringUtils.formatToHtml(h);j=true;}}if(j){a(c).replaceWith(a.parseHTML(h));}else{c.textContent=h;}}}};Text.CONTENTTYPE["text/html"]=Text.CONTENTTYPE["html"];Text.CONTENTTYPE["application/json"]=Text.CONTENTTYPE["json"];Text.CONTENTTYPE["text/plain"]=Text.CONTENTTYPE["text"];de.titus.jstl.TaskRegistry.append("text",de.titus.jstl.Constants.PHASE.CONTENT,undefined,de.titus.jstl.functions.Text.TASK);});})($);(function(a){de.titus.core.Namespace.create("de.titus.jstl.functions.Attribute",function(){let Attribute=de.titus.jstl.functions.Attribute={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Attribute"),TASK:function(h,g,d,c){if(Attribute.LOGGER.isDebugEnabled()){Attribute.LOGGER.logDebug("execute run("+h+", "+g+", "+d+")");}let attributes=h[0].attributes||[];for(var b=0;b<attributes.length;b++){let name=attributes[b].name;if(name.indexOf("jstl-")!=0){let value=attributes[b].value;if(value!=undefined&&value!=""){try{let newValue=d.resolver.resolveText(value,g);if(value!=newValue){if(Attribute.LOGGER.isDebugEnabled()){Attribute.LOGGER.logDebug('Change attribute "'+name+'" from "'+value+'" to "'+newValue+'"!');}h.attr(name,newValue);}}catch(f){Attribute.LOGGER.logError("Can't process attribute\""+name+'" with value "'+value+'"!');}}}}c.nextTask();}};de.titus.jstl.TaskRegistry.append("attribute",de.titus.jstl.Constants.PHASE.CONTENT,undefined,de.titus.jstl.functions.Attribute.TASK);});})($);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.Data",function(){let Data=de.titus.jstl.functions.Data={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Data"),TASK:function(f,e,d,c){if(Data.LOGGER.isDebugEnabled()){Data.LOGGER.logDebug("TASK");}let expression=f.attr("jstl-data");if(typeof expression!=="undefined"){let varname=f.attr("jstl-data-var");let defaultValue=Data.__defaultvalue(f,expression,e,d);let mode=f.attr("jstl-data-mode")||"direct";Data.MODES[mode](expression,defaultValue,f,varname,e,d,c);}else{c.nextTask();}},__defaultvalue:function(e,f,d,c){let defaultExpression=e.attr("jstl-data-default");if(typeof defaultExpression==="undefined"){return f;}else{if(defaultExpression.length==0){return undefined;}else{return c.resolver.resolveExpression(defaultExpression,d,f);}}},__options:function(e,d,c){let options=e.attr("jstl-data-options");if(options){options=c.resolver.resolveText(options,d);options=c.resolver.resolveExpression(options,d);return options;}},__updateContext:function(d,c,e){if(c){if(!d){e.updateContext(c,true);}else{e.context[d]=c;}}},MODES:{"direct":function(j,h,g,c,f,e,d){let data=e.resolver.resolveExpression(j,f,h);
Data.__updateContext(c,data,d);d.nextTask();},"remote":function(j,h,g,c,f,e,d){let url=e.resolver.resolveText(j,f);url=de.titus.core.Page.getInstance().buildUrl(url);let option=Data.__options(g,f,e);let datatype=(g.attr("jstl-data-datatype")||"json").toLowerCase();let ajaxSettings={"url":url,"async":true,"cache":false,"dataType":datatype,"success":function(k,m,l){Data.__remoteResponse(c,datatype,d,ajaxSettings,k,m,l);},"error":function(l,m,k){Data.__remoteError(g,d,ajaxSettings,l,m,k);}};if(option){ajaxSettings=b.extend(ajaxSettings,option);}b.ajax(ajaxSettings);},"url-parameter":function(j,h,g,c,f,e,d){let parameterName=e.resolver.resolveText(j,f,j);let data=de.titus.core.Page.getInstance().getUrl().getParameter(parameterName);if(typeof data!=="undefined"){Data.__updateContext(c,data,d);}else{if(typeof h!=="undefined"){Data.__updateContext(c,h,d);}}d.nextTask();}},CONTENTYPE:{"xml":de.titus.core.Converter.xmlToJson,"json":function(c){return c;}},__remoteResponse:function(g,j,h,c,d,f,e){if(Data.LOGGER.isDebugEnabled()){Data.LOGGER.logDebug(['add remote data "',d,' as var "',g,'" as datatype "',j,'" -> (request: "',c,'", response: "',e,'")']);}Data.__updateContext(g,Data.CONTENTYPE[j](d),h);h.nextTask();},__remoteError:function(h,g,c,e,f,d){Data.LOGGER.logError(['jstl-data error at element "',h,'" -> request: "',c,'", response: "',e,'", state: "',f,'" error: "',d,'"!']);g.finish();}};de.titus.jstl.TaskRegistry.append("data",de.titus.jstl.Constants.PHASE.CONTEXT,"[jstl-data]",de.titus.jstl.functions.Data.TASK);});})($,de.titus.jstl.GlobalSettings);(function(b,a){de.titus.core.Namespace.create("de.titus.jstl.functions.Include",function(){let Include=de.titus.jstl.functions.Include={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Include"),CACHE:{},TASK:function(f,e,d,c){if(Include.LOGGER.isDebugEnabled()){Include.LOGGER.logDebug("execute run("+f+", "+e+", "+d+")");}let expression=f.attr("jstl-include");if(typeof expression!=undefined){Include.__compute(expression,f,e,d,c);}else{c.nextTask();}},__cacheCallback:function(g,e,f,d,c){Include.__include(g,c,e,f,d);},__executeCacheCallback:function(d,c){Include.CACHE[d]={"template":b("<jstl/>").append(c),"onload":false};let cache=Include.CACHE[d];for(let i=0;i<cache.callback.length;i++){cache.callback[i](cache.template);}},__compute:function(c,g,f,e,d){let url=e.resolver.resolveText(c,f);url=Include.__buildUrl(url);let disableCaching=url.indexOf("?")>=0||typeof g.attr("jstl-include-cache-disabled")!=="undefined";let cache=undefined;if(!disableCaching){cache=Include.CACHE[url];}if(cache){if(cache.onload){cache.callback.push(function(h){Include.__cacheCallback(g,e,f,d,h);});}else{Include.__include(g,cache.template,e,f,d);}}else{cache=Include.CACHE[url]={onload:true,callback:[function(h){Include.__cacheCallback(g,e,f,d,h);}]};ajaxSettings=b.extend({"url":url,"async":true,"cache":(typeof g.attr("jstl-include-ajax-cache-disabled")==="undefined"),"dataType":"html"},Include.__options(g,f,e));ajaxSettings.success=function(h){Include.__executeCacheCallback(url,h);};ajaxSettings.error=function(j,k,h){Include.__remoteError(g,d,ajaxSettings,j,k,h);};b.ajax(ajaxSettings);}},URLPATTERN:new RegExp("^((https?://)|/).*","i"),__buildUrl:function(c){let url=c;if(!Include.URLPATTERN.test(c)){url=a.DEFAULT_INCLUDE_BASEPATH+c;}url=de.titus.core.Page.getInstance().buildUrl(url);if(Include.LOGGER.isDebugEnabled()){Include.LOGGER.logDebug('execute __buildUrl("'+c+'") -> result: '+url);}return url;},__options:function(e,d,c){let options=e.attr("jstl-include-options");if(options){options=c.resolver.resolveText(options,d);options=c.resolver.resolveExpression(options,d);return options;}},__mode:function(e,d,c){let mode=e.attr("jstl-include-mode");if(mode==undefined){return"replace";}mode=mode.toLowerCase();if(mode=="append"||mode=="replace"||mode=="prepend"){return mode;}return"replace";},__include:function(g,c,e,f,d){if(Include.LOGGER.isDebugEnabled()){Include.LOGGER.logDebug("execute __include()");}let content=c.clone();let includeMode=Include.__mode(g,f,e);if(includeMode=="replace"){g.empty();content.appendTo(g);}else{if(includeMode=="append"){content.appendTo(g);}else{if(includeMode=="prepend"){content.prependTo(g);}}}d.nextTask();},__remoteError:function(h,g,c,e,f,d){Include.LOGGER.logError(['jstl-include error at element "',h,'" -> request: "',c,'", response: "',e,'", state: "',f,'" error: "',d,'"!']);g.finish();}};de.titus.jstl.TaskRegistry.append("include",de.titus.jstl.Constants.PHASE.MANIPULATION,"[jstl-include]",de.titus.jstl.functions.Include.TASK);});})($,de.titus.jstl.GlobalSettings);(function(a){de.titus.core.Namespace.create("de.titus.jstl.functions.AddAttribute",function(){var b=de.titus.jstl.functions.AddAttribute={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.AddAttribute"),TASK:function(f,e,d,c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("execute run("+f+", "+e+", "+d+")");}var g=f.attr("jstl-add-attribute");if(g){g=d.resolver.resolveExpression(g,e,false);if(g&&typeof g==="function"){g=g(f,e,d);}if(g&&Array.isArray(g)){b.processArray(g,f,e,d);}else{if(g&&typeof g==="object"){b.processObject(g,f,e,d);}}}c.nextTask();},processArray:function(d,g,f,e){for(var c=0;c<d.length;c++){b.processObject(d[c],g,f,e);}},processObject:function(c,f,e,d){if(c.name){f.attr(c.name,c.value);}else{b.LOGGER.logError("run processObject ("+c+", "+f+", "+e+", "+d+") -> No attribute name defined!");}}};de.titus.jstl.TaskRegistry.append("add-attribute",de.titus.jstl.Constants.PHASE.CONTENT,"[jstl-add-attribute]",de.titus.jstl.functions.AddAttribute.TASK);});})($);(function(a){de.titus.core.Namespace.create("de.titus.jstl.functions.Databind",function(){var b=de.titus.jstl.functions.Databind={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Databind"),TASK:function(h,g,f,e){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("execute run("+h+", "+g+", "+f+")");}var c=h.attr("jstl-databind-name");if(c&&c.trim()!=""){var d=b.__value(h,g,f);if(d!=undefined){h.data(c,d);}}e.nextTask();},__value:function(e,d,c){return c.resolver.resolveExpression(e.attr("jstl-databind"),d,undefined);}};de.titus.jstl.TaskRegistry.append("databind",de.titus.jstl.Constants.PHASE.BINDING,"[jstl-databind]",de.titus.jstl.functions.Databind.TASK);});})($);(function(a){de.titus.core.Namespace.create("de.titus.jstl.functions.Eventbind",function(){var b=de.titus.jstl.functions.Eventbind={LOGGER:de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Eventbind"),TASK:function(f,e,d,c){if(b.LOGGER.isDebugEnabled()){b.LOGGER.logDebug("execute run("+f+", "+e+", "+d+")");}if(f.attr("jstl-eventbind")!=undefined){f.de_titus_core_EventBind(e);}c.nextTask();}};de.titus.jstl.TaskRegistry.append("eventbind",de.titus.jstl.Constants.PHASE.BINDING,"[jstl-eventbind]",de.titus.jstl.functions.Eventbind.TASK);});})($);(function(b,c,a){de.titus.core.Namespace.create("de.titus.jstl.Processor",function(){var d=function(g,f,e){this.element=g;this.parent=this.element.parent();this.context=f||{};this.callback=e;this.resolver=new de.titus.core.ExpressionResolver(this.element.data("jstlExpressionRegex"));};d.LOGGER=de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.Processor");d.prototype.compute=function(g,f,e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug(['execute compute("',g,'", "',f,'")']);}if(!g){this.element.removeClass("jstl-ready");this.element.addClass("jstl-running");this.element.trigger(de.titus.jstl.Constants.EVENTS.onStart,[f,this]);this.__computeElement(this.element,this.context,true,this.callback);}else{this.__computeElement(g,f,false,e);}};d.prototype.__computeElement=function(h,g,f,e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug(["__computeElement() -> root: ",f,'"']);}let self=this;let taskChain=new de.titus.jstl.TaskChain(h,g,this,f,function(k,j){self.__computeFinished(f,e,k,j);});taskChain.nextTask();};d.prototype.__computeFinished=function(f,e,j,h){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("__computeFinished() -> is root: "+f);}if(typeof e==="function"){e(j,h,this,f);}var g=j.tagName();if((g=="x-jstl"||g=="jstl")&&j.contents().length>0){j.replaceWith(j.contents());}if(f){this.context=h;this.onReady();}};d.prototype.onReady=function(e){if(d.LOGGER.isDebugEnabled()){d.LOGGER.logDebug("onReady()");}if(e){this.element.one(de.titus.jstl.Constants.EVENTS.onReady,function(f){e(f.delegateTarget,f.data);});return this;}else{let self=this;setTimeout(function(){self.element.removeClass("jstl-running");self.element.addClass("jstl-ready");self.element.trigger(de.titus.jstl.Constants.EVENTS.onReady,[self]);},a.DEFAULT_TIMEOUT_VALUE*10);}};de.titus.jstl.Processor=d;});})(jQuery,de.titus.core.SpecialFunctions,de.titus.jstl.GlobalSettings);de.titus.core.Namespace.create("de.titus.jstl.javascript.polyfills",function(){if(!Array.from){Array.from=(function(){var d=Object.prototype.toString;var e=function(g){return typeof g==="function"||d.call(g)==="[object Function]";};var c=function(h){var g=Number(h);if(isNaN(g)){return 0;}if(g===0||!isFinite(g)){return g;}return(g>0?1:-1)*Math.floor(Math.abs(g));};var b=Math.pow(2,53)-1;var a=function(h){var g=c(h);return Math.min(Math.max(g,0),b);};return function f(q){var g=this;var p=Object(q);if(q==null){throw new TypeError("Array.from requires an array-like object - not null or undefined");}var n=arguments.length>1?arguments[1]:void undefined;var j;if(typeof n!=="undefined"){if(!e(n)){throw new TypeError("Array.from: when provided, the second argument must be a function");}if(arguments.length>2){j=arguments[2];}}var o=a(p.length);var h=e(g)?Object(new g(o)):new Array(o);var l=0;var m;while(l<o){m=p[l];if(n){h[l]=typeof j==="undefined"?n(m,l):n.call(j,m,l);}else{h[l]=m;}l+=1;}h.length=o;return h;};}());}});(function(a){de.titus.core.Namespace.create("de.titus.jquery.jstl.plugin",function(){a.fn.jstl=function(b){if(this.length==0){return;}else{if(this.length>1){return this.each(function(){return a(this).jstl(b);
});}else{var c=this.data("de.titus.jstl.Processor");if(!c){var d=b||{};c=new de.titus.jstl.Processor(this,a.extend(true,{},d.data),d.callback||d.success);this.data("de.titus.jstl.Processor",c);}else{if(b){var d=b||{};if(d.data){c.context=a.extend(true,{},d.data);}if(typeof d.callback==="function"){c.callback=d.callback;}}}c.compute();return c;}}};a.fn.jstlAsync=function(d){if(this.length==0){return;}else{if(this.length>1){var b=[];this.each(function(){var e=a(this).jstlAsync(d);if(e){b.push(e);}});return b;}else{var c=this;setTimeout(function(){c.jstl(d);},1);return this;}}};a(document).ready(function(){a("[jstl-autorun]").jstlAsync();});});}(jQuery));