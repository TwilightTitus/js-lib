de.titus.core.Namespace.create("de.titus.jstl.functions.Databind", function() {
	de.titus.jstl.functions.Databind = function() {
	};
	de.titus.jstl.functions.Databind.prototype = new de.titus.jstl.IFunction("databind");
	de.titus.jstl.functions.Databind.prototype.constructor = de.titus.jstl.functions.Databind;
	
	/**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
	 * static variables
	 *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
	de.titus.jstl.functions.Databind.LOGGER = de.titus.logging.LoggerFactory.getInstance().newLogger("de.titus.jstl.functions.Databind");
	
	/**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
	 * functions
	 *********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
	
	de.titus.jstl.functions.Databind.prototype.run = function(aElement, aDataContext, aProcessor) {
		if (de.titus.jstl.functions.Databind.LOGGER.isDebugEnabled())
			de.titus.jstl.functions.Databind.LOGGER.logDebug("execute run(" + aElement + ", " + aDataContext + ", " + aProcessor + ")");
		
		var expressionResolver = aProcessor.expressionResolver || new de.titus.core.ExpressionResolver();
		
		var varname = this.getVarname(aElement, aDataContext, aProcessor, expressionResolver);
		if (varname != undefined && varname.trim().length != 0) {
			var value = this.getValue(aElement, aDataContext, aProcessor, expressionResolver);
			if(value != undefined)
				aElement.data(varname, value);			
		}
		
		return new de.titus.jstl.FunctionResult(true, true);
	};
	
	de.titus.jstl.functions.Databind.prototype.getVarname = function(aElement, aDataContext, aProcessor, anExpressionResolver) {
		return aElement.attr(aProcessor.config.attributePrefix + this.attributeName + "-name");
	};
	
	de.titus.jstl.functions.Databind.prototype.getValue = function(aElement, aDataContext, aProcessor, anExpressionResolver) {
		var valueString =  aElement.attr(aProcessor.config.attributePrefix + this.attributeName);
		
		return anExpressionResolver.resolveExpression(valueString, aDataContext, undefined);
	};
});
